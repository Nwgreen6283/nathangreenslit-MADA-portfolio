---
title: "Tidy Tuesday Exercise"
output: 
  html_document:
    toc: FALSE
---

## Loading Packages

```{r, message = FALSE}
library(tidyverse)
library(here)
library(tidytuesdayR)
library(lubridate)
library(skimr)
```

## The Data

```{r, message = FALSE}
tuesdata <- tidytuesdayR::tt_load(2023, week = 7)
age_gaps <- tuesdata$age_gaps
```

### Take a look at the data

```{r}
glimpse(age_gaps)
summary(age_gaps)
```

It looks like we have data from 1935-2022 that contains the movie, director, each actors age and gender, and their birth-dates. For each couple, the age gap is defined in the age_difference column.\
This dataset seems to be fairly clean, with consistent entries for each variable. So lets think about some analyses we can explore.

## Analysis Ideas

#### 1. How has the age gap changed over the years?

#### 2. What is the most common age differnce?

#### 3. Are age gaps where the male is older than the female more common? Or vice versa?

#### 4. Do we see a greater age gap between same-sex or oposite-sex couples?

## 1. How has age gap changed over the years?

### Slim down Data

```{r}
d1 <- age_gaps %>%
  select(release_year, age_difference)
```

Lets just look at the release year and age gap.

### Average gap by year

```{r}
year_avg<- d1 %>%
group_by(release_year) %>% 
summarize_if(is.numeric, mean) %>%
ungroup()
```

Because multiple movies came out in the same year, we are taking an average of the age gap per year.

### Plotting avereage age gap over the years

```{r}
year_avg %>%
  ggplot() + 
  geom_line(
    aes(
      x = release_year,
      y = age_difference),
    color = "darkgreen")+
  geom_point(
    aes(
      x = release_year,
      y = age_difference),
    color = "darkgreen")+
  theme_bw()+
  labs(
    x = "Release Year",
    y = "Age Gap",
    title = "Age gaps in movies from 1935-2022") +
  theme(
    plot.title = element_text(hjust = 0.5))

```

Nothing really stands out here. We see a slight decrease in average age gap between \~1980-2018. the years 2020 and 2022 both had movies with age gaps \>20 years (You Should Have Left, Mank, The Northman, and The Bubble).

## 2. What is the most common age difference?

### Let's make a dataframe that contains the number of times an age gap is reported:

```{r}
dist<- age_gaps %>%
  count(age_difference)
summary(dist)
```

### Now let's plot it:

```{r}
dist %>%
  ggplot() +
  geom_point(
    aes(
      x = age_difference,
      y = n),
    color = "darkblue")+
  geom_line(
    aes(
      x = age_difference,
      y = n),
    color = "darkblue")+
  theme_bw()+
 scale_x_continuous(n.breaks=10)+
  labs(
    x = "Age Gap",
    y = "Number of Times Age Gap Appears",
    title = "Frequency of Age Gaps in Media" )+
  theme(plot.title = element_text(hjust = 0.5))
```

It looks like an age gap of 2-3 years is most common.

## 3. Are age gaps where the male is older than the female more common? Or vice versa?

### Make new column that identifies the older male or female        (character_1\_gender refers to gender of older actor)

```{r}
age_gaps2<- age_gaps %>%
  mutate(older = case_when(age_gaps$character_1_gender == "woman"~ "Female", # Older Female
                           age_gaps$character_1_gender == "man" ~ "Male"))  # Older Male 

```

### Plot Age difference over time by gender

```{r}
age_gaps2 %>% ggplot() + geom_point(
  aes(
    x = release_year,
    y = age_difference,
    color = older))+
  theme_bw()+
  labs(
    x = "Movie Release Year",
    y = "Age Difference",
    title = "Age Difference over Release Years by Gender",
    color = "Older Actor")+
    theme(
      plot.title = element_text(hjust = 0.5))

```

A few things to note here. (1) It looks like older female couples become more prevalent around the 1980s. (2) Despite a higher incidence of older female couples, the age gap is relatively lower than that of older male couples. (3) Some of the movies include same-sex couples, which can make this graph misleading. In the case where the couple is woman-woman, older female will show up regardless.

### Make new columns and dataframes for same and opposite sex couples
```{r}
age_gaps3<- age_gaps2 %>%
  mutate(sex = case_when(
    #Same-sex male couples
    (age_gaps$character_1_gender == "man" & age_gaps$character_2_gender == "man") ~"same", 
    #Same-sex female couples
    (age_gaps$character_1_gender == "woman" & age_gaps$character_2_gender == "woman") ~"same", 
    #Opposite-sex couples
    (age_gaps$character_1_gender == "woman" & age_gaps$character_2_gender == "man") ~"dif", 
     #Opposite-sex couples
    (age_gaps$character_1_gender == "man" & age_gaps$character_2_gender == "woman") ~"dif")) 

#New dataframes for same and oppoiste sex relationships 
age_same<- age_gaps3 %>%
  filter(sex %in% "same")

age_opp<- age_gaps3 %>%
  filter(sex %in% "dif")
```

```{r}
glimpse(age_same)
```
From this, we can see that 23 entereies are same-sex couples.


### Plot Opposite sex couples
```{r}
age_opp %>% ggplot() + geom_point(
  aes(
    x = release_year,
    y = age_difference,
    color = older))+
  theme_bw()+
  labs(
    x = "Movie Release Year",
    y = "Age Difference",
    title = "Age Difference over Release Years by Gender of Opposite-sex Couples",
    color = "Older Actor")+
    theme(
      plot.title = element_text(hjust = 0.5))

```
This is not drastically different from the previous graph. But let's look at everything together. 

### Plot everything together
```{r}
age_gaps3 %>% ggplot() + geom_point(
  aes(
    x = release_year,
    y = age_difference,
    color = older,
    shape = sex))+
  theme_bw()+
  labs(
    x = "Movie Release Year",
    y = "Age Difference",
    title = "Age Difference over Release Years by Gender",
    color = "Older Actor")+
    theme(
      plot.title = element_text(hjust = 0.5))
 # scale_color_manual(values = c("Male" = "grey","Female" = "#F88379"))+
 # scale_shape_manual(values = c("dif" = 2, "same" = 20))
```

## 4. Do we see a greater age gap between same-sex or opoosite-sex couples?
```{r}
age_gaps3 %>% ggplot() + geom_boxplot(
  aes(
    x = sex,
    y = age_difference,
  color = sex))
```
On average, there is a greater age gap in same sex couples, but it is important to note that there are only 23 entries for same-sex couples and 1132 entereies for opposite sex couples. 

### Same-sex prevalance in film
```{r}
age_gaps3 %>% ggplot() + geom_point(
  aes(
    x = release_year,
    y = age_difference,
    color = sex))+
  scale_color_manual(values = c("dif" = "grey", "same" = "darkblue"))
```






